<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Hoher Fl√§ming Helicopter Explorer</title>
    <link rel="stylesheet" href="index.css">
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.12.0"
  }
}
</script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-content">
            <div class="loading-helicopter">üöÅ</div>
            <div class="loading-text">Planning your route...</div>
            <div class="loading-bar">
                <div class="loading-bar-fill"></div>
            </div>
        </div>
    </div>

    <!-- Map Container -->
    <div id="map-container">
        <div id="map-viewport">
            <img id="map-image" alt="Hoher Fl√§ming Map">
            
            <!-- Helicopter -->
            <div id="helicopter-container">
                <div id="helicopter">
                    <svg width="60" height="60" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                      <g transform="translate(50,50)">
                        <!-- Shadow -->
                        <g transform="translate(2, 2)" opacity="0.2">
                          <path d="M0,20 Q-25,20 -25,0 Q-25,-25 0,-25 Q25,-25 25,0 Q25,20 0,20 Z" fill="#000" />
                          <rect x="-4" y="18" width="8" height="30" rx="4" fill="#000" />
                        </g>
                        
                        <!-- Tail -->
                        <rect x="-4" y="18" width="8" height="30" rx="4" fill="#6b5f55" stroke="#3d352e" stroke-width="2"/>
                        <g transform="translate(0, 48)">
                          <path d="M-10,0 H10" stroke="#3d352e" stroke-width="4" stroke-linecap="round" />
                        </g>
                        
                        <!-- Body -->
                        <path d="M0,20 Q-25,20 -25,0 Q-25,-25 0,-25 Q25,-25 25,0 Q25,20 0,20 Z" fill="#8c7851" stroke="#3d352e" stroke-width="2" />

                        <!-- Cockpit Glass -->
                        <path d="M0,-23 Q-20,-23 -20,-5 L20,-5 Q20,-23 0,-23 Z" fill="#d1e0e0" opacity="0.8" />
                        
                        <!-- Skids -->
                        <path d="M-20,15 H20 M-15,10 V20 M15,10 V20" stroke="#3d352e" stroke-width="4" stroke-linecap="round" />
                        
                        <!-- Main Rotor -->
                        <g id="main-rotor">
                          <rect x="-48" y="-2.5" width="96" height="5" rx="2.5" fill="#3d352e" opacity="0.8"/>
                          <rect x="-48" y="-2.5" width="96" height="5" rx="2.5" fill="#3d352e" opacity="0.8" transform="rotate(90)"/>
                        </g>
                        
                        <!-- Rotor Hub -->
                        <circle cx="0" cy="0" r="10" fill="#6b5f55" stroke="#3d352e" stroke-width="2" />
                      </g>
                    </svg>
                </div>
            </div>
        </div>
    </div>

    <!-- HUD -->
    <div id="hud-container">
        <div class="hud-panel">
            <div class="hud-row">
                <span class="hud-label">Speed</span>
                <span class="hud-value" id="speed-display">0.0</span>
            </div>
            <div class="hud-row">
                <span class="hud-label">POIs Visited</span>
                <span class="hud-value" id="poi-count">0/16</span>
            </div>
             <div class="hud-row">
                <span class="hud-label">Time</span>
                <span class="hud-value" id="time-display">00:00</span>
            </div>
        </div>

        <div class="hud-panel">
            <div class="hud-row">
                <span class="hud-label">Heading</span>
                <span class="hud-value" id="heading-display">0¬∞</span>
            </div>
            <div id="compass">
                <div id="compass-ring">N</div>
                <div id="compass-needle"></div>
            </div>
        </div>
    </div>

    <!-- Controls -->
    <div id="controls-container">
        <div id="joystick-container">
            <div id="joystick-base"></div>
            <div id="joystick-handle"></div>
        </div>
        
        <div class="action-buttons">
            <button class="action-button" id="land-button">Land</button>
            <button class="action-button secondary visible" id="menu-button" title="Menu">‚ò∞</button>
        </div>
    </div>

    <!-- Minimap -->
    <div id="minimap">
        <canvas id="minimap-canvas"></canvas>
    </div>

    <!-- Menu -->
    <div id="menu-container">
        <div id="menu-header">
            <h2 id="menu-title">Mission Log</h2>
            <button id="menu-close">‚úï</button>
        </div>
        <div id="menu-content">
            <div class="menu-section">
                <div class="menu-section-title">Flight Statistics</div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-distance">0</div>
                        <div class="stat-label">Distance (km)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-max-speed">0</div>
                        <div class="stat-label">Max Speed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-landings">0</div>
                        <div class="stat-label">Landings</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-completion">0%</div>
                        <div class="stat-label">Completion</div>
                    </div>
                </div>
            </div>
            
            <div class="menu-section">
                <div class="menu-section-title">Points of Interest</div>
                <div id="poi-list"></div>
            </div>
        </div>
    </div>

    <!-- POI Modal -->
    <div id="poi-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-icon" id="modal-icon">1</div>
                <h2 id="poi-modal-title">Point of Interest</h2>
            </div>
            <p class="modal-description" id="poi-modal-description"></p>
            <div class="modal-stats">
                <div class="modal-stat">
                    <div class="modal-stat-value" id="modal-visit-time">--:--</div>
                    <div class="modal-stat-label">Visit Time</div>
                </div>
                <div class="modal-stat">
                    <div class="modal-stat-value" id="modal-poi-number">1/16</div>
                    <div class="modal-stat-label">Progress</div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-button" id="continue-button">Continue Flying</button>
                <button class="modal-button secondary" id="next-poi-button">Next POI ‚Üí</button>
            </div>
        </div>
    </div>

    <!-- Completion Modal -->
    <div id="completion-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-icon">üèÜ</div>
                <h2>Mission Complete!</h2>
            </div>
            <p class="modal-description">
                Congratulations, pilot! You've successfully explored all 16 points of interest in the Hoher Fl√§ming Nature Park.
            </p>
            <div class="modal-stats">
                <div class="modal-stat">
                    <div class="modal-stat-value" id="final-time">00:00</div>
                    <div class="modal-stat-label">Total Time</div>
                </div>
                <div class="modal-stat">
                    <div class="modal-stat-value" id="final-distance">0 km</div>
                    <div class="stat-label">Distance Flown</div>
                </div>
                <div class="modal-stat">
                    <div class="modal-stat-value" id="final-speed">0</div>
                    <div class="stat-label">Avg Speed</div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-button" id="restart-button">New Mission</button>
                <button class="modal-button secondary" id="explore-button">Free Flight</button>
            </div>
        </div>
    </div>

    <!-- Achievement Toast -->
    <div id="achievement-toast" class="achievement-toast">
        <span class="achievement-icon">üèÜ</span>
        <span class="achievement-text" id="achievement-text">Achievement Unlocked!</span>
    </div>

    <script type="module" src="index.tsx"></script>
</body>
</html>